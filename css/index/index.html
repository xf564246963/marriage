<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>熊峰&余盼婚礼请柬</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="screen-orientation" content="portrait">
    <!-- QQ强制竖屏 -->
    <meta name="x5-orientation" content="portrait">
    <link rel="stylesheet" type="text/css" href="../css/jquery.fullPage.css" />
    <link rel="stylesheet" type="text/css" href="./css/base.css" />
    <script type="text/javascript" src="../js/jquery.js"></script>

    <script type="text/javascript" src="../js/jquery.fullPage.js"></script>

    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=8BB7F0E5C9C77BD6B9B655DB928B74B6E2D838FD"></script>

    <script type="text/javascript">

        $(function () {
            $('#fullpage').fullpage({
                scrollOverflow: true,
                normalScrollElements: '.scrollable-element',
                onLeave:function (index,nextIndex,direction) {
                    pageManage[nextIndex-1]&&pageManage[nextIndex-1]();
                    if(nextIndex-1!=6){
                        document.querySelector(".leaf-scene").style.display = "none";
                        pageManage.pageData[nextIndex-1]&&cancelAnimationFrame(pageManage.pageData[nextIndex-1].interval);
                    }
                },
                afterRender: function() {
                },
                afterLoad: function(anchorLink,index) {
                }
            });
            LEAFS.init();
            var imageObject = {};
            imageObject.imageObject = new Image;
            imageObject.imageObject.src = "./image/7-bg.png";
            imageObject.imageObject.onload = function(){
                imageObject.imgClipData = {};
                imgResponseAsBg(imageObject);
                imageObject.imgClipData.x = -parseInt(imageObject.imgClipData.width*3/4 - window.innerWidth*3/4);
                $(".page7-bg").css("background","url(" + imageObject.imageObject.src + ") no-repeat "
                        + imageObject.imgClipData.x + "px " + imageObject.imgClipData.y + "px/"
                        + imageObject.imgClipData.width + "px " + imageObject.imgClipData.height + "px")
            }

        });

        function imgResponseAsBg(imageObject) {
            if (Object.prototype.toString.call(imageObject) === "[object Object]") {
                var img = imageObject.imageObject;
                imageObject.imgClipData = {};
                //canvas background 自适应
                if (img.width / img.height >= window.innerWidth / window.innerHeight) {
                   imageObject.imgClipData.width = parseInt(window.innerHeight * img.width / img.height);
                   imageObject.imgClipData.height = window.innerHeight;
                   imageObject.imgClipData.x = -(imageObject.imgClipData.width - window.innerWidth) / 2;
                   imageObject.imgClipData.y = 0;
                } else {
                   imageObject.imgClipData.width = window.innerWidth;
                   imageObject.imgClipData.height = parseInt(window.innerWidth * img.height / img.width);
                   imageObject.imgClipData.x = 0;
                   imageObject.imgClipData.y = -(imageObject.imgClipData.height - window.innerHeight) / 2;
                }
            }
        }

        var pageManage = {
            "1":function(){
                if($(".page2-bg>.center-obj>svg")){
                    $(".page2-bg>.center-obj>svg").remove();
                }
                $(".page2-bg>.center-obj").prepend('<svg class="page2-svg" xmlns="http://www.w3.org/2000/svg" version="1.1" preserveAspectRatio="none" x="0px" y="0px" width="320px" height="200px" viewBox="0 0 320 200"> <g> <animateMotion path="M 30 141 Q 59.35 116.65 112.6 86.4 139.25 71.25 160 61 L 164 59.4Q 169 57.5 174 56.25 190 52.25 200 56 204 57.5 212.65 60.65 220.35 63.8 226.75 67.9 244.1 78.95 261 103" begin="0s" dur="5s" rotate="auto-reverse" fill="freeze"/> <image href="./image/train.png" height="40" width="40"/> </g> <path stroke="#ffffff" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d="M 30 141 Q 59.35 116.65 112.6 86.4 139.25 71.25 160 61 L 164 59.4Q 169 57.5 174 56.25 190 52.25 200 56 204 57.5 212.65 60.65 220.35 63.8 226.75 67.9 244.1 78.95 261 103"/> <text font-family="幼圆" font-size="12" fill="#fff" y="160" x="25" opacity="0">孝感 <animate attributeName="opacity" from="0" to="1" begin="0s" dur="2s" fill="freeze"/> </text> <text font-family="幼圆" font-size="12" fill="#fff" y="80" x="165" opacity="0">合肥 <animate attributeName="opacity" from="0" to="1" begin="2s" dur="1.5s" fill="freeze"/> </text> <text font-family="幼圆" font-size="12" fill="#fff" y="125" x="260" opacity="0">上海 <animate attributeName="opacity" from="0" to="1" begin="3.5s" dur="1.5s" fill="freeze"/></text></svg>')
                var date = new Date();
                var month = date.getMonth()>=9?date.getMonth()+1:"0"+(date.getMonth()+1);
                //$(".page2-month").text(month);
                clearInterval(this.pageData[1].interval);
                var memorialDay = new Date("2010/12/06");
                var diffDay = parseInt(Math.abs(date.getTime() - memorialDay.getTime()) / 1000 / 60 / 60 /24);

                var inputContent = "", inputContentArr = ["2010.12.06","从孝感、合肥、到上海",diffDay+"天","一路有你","不负时光"];
                var j = 0, i = 0;
                this.pageData[1].interval = setInterval(function () {
                    var textArr = inputContentArr[j].split("");
                    inputContent += textArr[i];
                    $(".page2-context").html(inputContent+(i & 1? '_' : ''));
                    if(i>=textArr.length-1){
                        inputContent += "</br>";
                        i = 0;
                        j++;
                        if(j>=inputContentArr.length){
                            clearInterval(this.pageData[1].interval);
                            $(".page2-context").html(inputContent);
                        }
                    }else{
                        i++;
                    }
                }.bind(this),250);
            },
            "6": function () {
                document.querySelector(".leaf-scene").style.display = "block";
                !function leafAnimate(){
                    LEAFS.render();
                    this.pageData.interval = requestAnimationFrame(leafAnimate.bind(this));
                }.apply(this);
            },
            pageData:{
                "1":{
                    interval:null
                },
                "6":{
                    interval:null
                }
            }
        }
    </script>
</head>
<body>
<div id="fullpage">
    <div class="section active" id="section1">
        <div class="section-bg page1-bg">
            <div class="center-obj">
                <div class="page1-title">Our Wedding Day</div>
                <div class="page1-flower center">
                </div>
                <img class="page1-cover center" src="./image/1-cover.png" alt=""/>
                <div class="page1-date">2018.05.20</div>
                <div class="page1-name">熊峰<span>❤</span>余盼</div>
                <div class="page1-content">我们结婚了</div>
            </div>
        </div>
        <div class="bottom-icon fadeInUp animated infinite"></div>
    </div>
    <div class="section" id="section2">
        <div class="section-bg page2-bg">
            <div class="center-obj">
                <div class="page2-context">
                </div>
                <img src="./image/heart-1.png" class="page-2-heart-1" alt=""/>
                <img src="./image/heart-4.png" class="page-2-heart-2" alt=""/>
            </div>
        </div>
        <div class="bottom-icon fadeInUp animated infinite"></div>
    </div>
    <div class="section" id="section3">
        <div class="section-bg">
            <div class="center-obj">
                <div class="page3-left-word">
                    <div>看</div>
                    <div>见</div>
                    <div>彼</div>
                    <div>此</div>
                </div>
                <div class="page3-right-word">
                    <div>即</div>
                    <div>是</div>
                    <div>青</div>
                    <div>春</div>
                </div>
                <img src="./image/3-man.jpg" alt="" class="page3-man"/>
                <img src="./image/3-woman.jpg" alt="" class="page3-woman"/>
            </div>
        </div>
        <div class="bottom-icon fadeInUp animated infinite"></div>
    </div>
    <div class="section" id="section4">
        <div class="section-bg page4-bg" >
            <!--<div class="center-obj" >-->
                <img class="page4-up" src="./image/4-up.png"/>
                <div class="page4-text">最美不过青春年少时<br/>遇到你</div>
                <img class="page4-down" src="./image/4-down.png" />
            <!--</div>-->
        </div>
        <div class="bottom-icon fadeInUp animated infinite"></div>
    </div>
    <div class="section" id="section5">
        <div class="section-bg page5-bg">
            <!--<div class="center-obj">-->
            <img class="page5-up" src="./image/5-up.png"/>
            <div class="page5-text">人生之旅 有你处处是风景</div>
            <img class="page5-left" src="./image/5-left.png"/>
            <img class="page5-right"src="./image/5-right.png"/>
            <!--</div>-->
        </div>
        <div class="bottom-icon fadeInUp animated infinite"></div>
    </div>
    <div class="section" id="section6">
        <div class="section-bg page6-bg">
            <!--<div class="center-obj">-->
            <img class="page6-up" src="./image/6-up.png"/>
            <div class="page6-text">
                <div>那<br/>天<br/>下<br/>午<br/>阳<br/>光<br/>正<br/>好<br/>，</div>
                <div>你<br/>穿<br/>一<br/>件<br/>白<br/>色<br/>衬<br/>衣</div>
            </div>
            <img class="page6-right"src="./image/6-right.png"/>
            <!--</div>-->
        </div>
        <div class="bottom-icon fadeInUp animated infinite"></div>
    </div>
    <div class="section" id="section7">
        <div class="section-bg page7-bg">
            <!--<div class="center-obj">-->
                <div class="falling-leaves"></div>
            <!--</div>-->
        </div>
        <div class="bottom-icon fadeInUp animated infinite"></div>
    </div>
    <div class="section" id="section8">
        <div class="section-bg">
            <div class="center-obj">
                <div class="page8-title">Say to Us</div>
                <input class="page8-input" type="tel" placeholder="手机号" maxlength="11" name="phone"/>
                <input class="page8-input" type="text" placeholder="姓名" maxlength="4" name="userName"/>
                <input class="page8-input" type="text" placeholder="祝福" name="wish"/>
                <div class="page8-button">提交</div>
                <div class="page8-contact box">
                    <div class="box-1">联系新郎</div>
                    <div class="box-1">联系新娘</div>
                </div>
            </div>
        </div>
    </div>
    <div class="section" id="section9">
        <div class="section-bg">
            <div class="center-obj">
                <div class="center page9-location" id="location"></div>
            </div>
        </div>
    </div>
</div>
<audio src="./audio/ifYouBecomeWind.mp3" autoplay="autoplay" loop="loop">
</audio>
<script src="./js/leaf.js"></script>
<script>
    // 百度地图API功能
    var map = new BMap.Map("location");

    // 创建地址解析器实例
    var myGeo = new BMap.Geocoder();
    // 将地址解析结果显示在地图上,并调整地图视野
    myGeo.getPoint("孝感市金华天商务酒店", function(point){
        if (point) {
            map.centerAndZoom(point, 20);
            map.addOverlay(new BMap.Marker(point));
        }
    }, "孝感市");
</script>
</body>
</html>